<!DOCTYPE html>
<html>
<head>
  <title>Swipe Spark - Chat</title>
  <style>
    body { font-family: Arial; }
    #messages { border: 1px solid #ccc; padding: 10px; height: 300px; overflow-y: scroll; }
    input, button { padding: 10px; margin-top: 5px; }
  </style>
</head>
<body>
  <h2>Welcome <%= name %> ðŸ‘‹</h2>
  <p>Your ID: <%= userId %></p>

  <div id="messages"></div>
  <input id="input" placeholder="Type a message" />
  <button onclick="send()">Send</button>
  <br><br>
  <button onclick="newChat()">ðŸ’¬ New Chat</button>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();
    const messages = document.getElementById('messages');

    socket.emit('join', "<%= userId %>");

    socket.on('chat message', data => {
      const div = document.createElement('div');
      div.innerText = `${data.name}: ${data.text}`;
      messages.appendChild(div);
    });

    function send() {
      const input = document.getElementById('input');
      const msg = input.value;
      socket.emit('chat message', { name: "<%= name %>", text: msg });
      input.value = '';
    }

    function newChat() {
      alert("Connecting to a new user... (real logic coming soon)");
      // In next steps, this will actually connect users
    }
  </script>
</body>
</html>
